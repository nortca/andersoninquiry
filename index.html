<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000; min-height: 14.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times}
    span.s1 {font-kerning: none}
    span.s2 {font-kerning: none; -webkit-text-stroke: 0px #000000}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;A+ Inquiry Scenario Builder&lt;/title&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- External Libraries: React, ReactDOM, and Tailwind CSS --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- jsPDF library for PDF generation --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"&gt;&lt;/script&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>body { font-family: 'sans-serif'; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- The React app will be rendered here --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="root"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!--<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>The entire application logic, including Firebase initialization and all React components,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>is now contained within this single module script. This eliminates script loading conflicts.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>--&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script type="module"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Import all necessary functions from the Firebase SDK</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { getFirestore, collection, addDoc, query, onSnapshot, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Make React functions available from the window object</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const { useState, useEffect, createElement } = window.React;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const { createPortal } = window.ReactDOM;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Firebase Configuration ---</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const firebaseConfig = {</span></p>
<p class="p3"><span class="s1">  apiKey: "AIzaSyBwqmfFw8h8aA05tRGA5HuC-h0FGZ2Sb68",</span></p>
<p class="p3"><span class="s1">  authDomain: "a-plus-inquiry-scenario-8b0c2.firebaseapp.com",</span></p>
<p class="p3"><span class="s1">  projectId: "a-plus-inquiry-scenario-8b0c2",</span></p>
<p class="p3"><span class="s1">  storageBucket: "a-plus-inquiry-scenario-8b0c2.firebasestorage.app",</span></p>
<p class="p3"><span class="s1">  messagingSenderId: "383121563246",</span></p>
<p class="p3"><span class="s1">  appId: "1:383121563246:web:f657d10d1e9dceb7c9507f",</span></p>
<p class="p3"><span class="s1">  measurementId: "G-NT839083TS"</span></p>
<p class="p3"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Form Field Definitions ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const formFields = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'scenarioTitle', label: 'Scenario Title', type: 'text' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'absorb', label: 'Absorb', description: "Existing knowledge of a context is acknowledged, and a knowledge gap (i.e., a need to know more about something) is identified. Guiding questions: What is already known about the context? What is the knowledge gap that needs to be filled? (i.e., What is not known but should be known about the context?) Why is it important to fill the knowledge gap?" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'ask', label: 'Ask', description: "Questions are formulated that, if answered, will help close the knowledge gap that was identified in the Absorb stage. Guiding question: What questions, if answered, could be formulated to help fill the knowledge gap identified in the Absorb stage?" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'accumulate', label: 'Accumulate', description: "Methods are described and implemented to collect quantitative and/or qualitative data that may be analyzed to answer the question(s) posed in the Ask stage. Guiding questions: What data could help answer the questions posed in the Ask stage? Do the data need to be collected or have they already been collected? When and where are the data collected? What instrument is utilized to collect the data? What is the procedure for collecting the data?" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'access', label: 'Access', description: "Data that were accumulated are retrieved from where they are stored or otherwise available in preparation for analysis. Guiding questions: Where are the data stored and retrieved after they have been collected in the Accumulate stage? What is the procedure for retrieving the data in preparation for analysis?" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'analyze', label: 'Analyze', description: "Analysis of the retrieved data is conducted. Guiding questions: What quantitative and/or qualitative data analysis methods are implemented to analyze the data that were retrieved in the Access stage? What tools are required to analyze the data?" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'answer', label: 'Answer', description: "Respond to the questions that were posed in the Ask stage based on the analysis of the data that was conducted in the Analyze stage and interpret limitations and implications of the answers. Guiding questions: What are the answers to the questions that were posed in the Ask stage, based on the analysis of the data that was conducted in the Analyze stage? How do the answers relate to what is already known about the context (e.g., the existing knowledge about the context that was identified in the Absorb stage)? What are limitations of the answers? What are implications of the answers?" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'announce', label: 'Announce', description: "The answers (i.e., data analysis results), along with applicable potential implications and limitations, are communicated to appropriate stakeholders. Guiding questions: Which stakeholders may benefit by being informed about the results that were revealed in the Answer stage? Which answers, limitations, and implications are important to communicate to each stakeholder? What is the procedure for disseminating the results to, and/or discussing the results with, the stakeholders?" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'apply', label: 'Apply', description: "Decisions are made based on the answers, limitations and implications of the answers, and applicable discussions among stakeholders. Guiding questions: What decisions or actions are informed by the results that were revealed in the Answer stage? Why are the decisions or actions important to implement? What cautions are considered when making decisions or taking actions based on the results?" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ id: 'comments', label: 'Comments', description: "Provide additional comments if needed." },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const initialFormState = formFields.reduce((acc, field) =&gt; ({ ...acc, [field.id]: '' }), {});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Reusable UI Components written with React.createElement ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const Button = ({ onClick, children, className = '', type = 'button', disabled = false }) =&gt; createElement('button', { type, onClick, className: `font-bold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-opacity-50 transition-colors duration-300 ${disabled ? 'bg-gray-400 cursor-not-allowed' : ''} ${className}`, disabled }, children);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const LoadingSpinner = ({ message }) =&gt; createElement('div', { className: "flex justify-center items-center h-screen bg-gray-100" }, createElement('div', { className: "text-center" }, createElement('div', { className: "animate-spin rounded-full h-24 w-24 border-t-2 border-b-2 border-blue-600 mx-auto" }), createElement('h2', { className: "text-xl font-semibold mt-4 text-gray-700" }, message)));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const InputField = ({ id, label, value, onChange, placeholder = '' }) =&gt; createElement(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>'div', { key: id },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>createElement('label', { htmlFor: id, className: "block text-sm font-bold text-gray-700 mb-1" }, label),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>createElement('input', { type: "text", id, name: id, value: value || '', onChange, placeholder, className: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500", required: true })</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const TextareaField = ({ id, label, description, value, onChange }) =&gt; createElement(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>'div', { key: id },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>createElement('label', { htmlFor: id, className: "block text-sm font-bold text-gray-800 mb-1" }, label),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>createElement('p', { className: "text-xs text-gray-500 mb-2" }, description),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>createElement('textarea', { id, name: id, value: value || '', onChange, rows: "5", className: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" })</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const DataForm = ({ onSave, initialData, onCancel, isEditMode, focusOnFieldId }) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [formData, setFormData] = useState(initialFormState);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>useEffect(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setFormData(initialData || initialFormState);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, [initialData]);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>useEffect(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (focusOnFieldId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const element = document.getElementById(focusOnFieldId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (element) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>setTimeout(() =&gt; {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>element.scrollIntoView({ behavior: 'smooth', block: 'center' });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>element.focus();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}, 100);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, [focusOnFieldId]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleChange = (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const { name, value } = e.target;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setFormData(prev =&gt; ({ ...prev, [name]: value }));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleSubmit = (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>e.preventDefault();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>onSave(formData);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return createElement('form', { onSubmit: handleSubmit, className: "space-y-6" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>...formFields.map(field =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const props = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>key: field.id,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>id: field.id,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>label: field.label,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>description: field.description,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>value: formData[field.id],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>onChange: handleChange</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return field.type === 'text'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>? createElement(InputField, props)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>: createElement(TextareaField, props);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement('div', { className: "flex justify-end space-x-3 pt-4" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>createElement(Button, { onClick: onCancel, className: "bg-gray-300 hover:bg-gray-400 text-gray-800" }, "Cancel"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>createElement(Button, { type: "submit", className: "bg-green-600 hover:bg-green-700 text-white" }, isEditMode ? 'Update Entry' : 'Save Entry')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const InquiryDiagram = ({ item, onStageClick }) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const diagramStages = formFields.filter(f =&gt; !['scenarioTitle', 'comments'].includes(f.id));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const centerX = 200;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const centerY = 200;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const radius = 180;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const angleStep = 2 * Math.PI / diagramStages.length;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const polarToCartesian = (angle, r) =&gt; ({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>x: centerX + r * Math.cos(angle),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>y: centerY + r * Math.sin(angle)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const filledStagesCount = diagramStages.filter(stage =&gt; item[stage.id] &amp;&amp; item[stage.id].trim() !== '').length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let centerColor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let textColor;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (filledStagesCount === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>centerColor = '#fee2e2';<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>textColor = 'text-red-800';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (filledStagesCount === diagramStages.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>centerColor = '#dcfce7';<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>textColor = 'text-green-800';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>centerColor = '#fef9c3';<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>textColor = 'text-yellow-800';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return createElement('svg', { viewBox: "0 0 400 400", className: "mx-auto my-4 max-w-lg" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>...diagramStages.map((stage, index) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const startAngle = angleStep * index - (Math.PI / 2) - (angleStep / 2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const endAngle = startAngle + angleStep;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const hasText = item[stage.id] &amp;&amp; item[stage.id].trim() !== '';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const start = polarToCartesian(startAngle, radius);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const end = polarToCartesian(endAngle, radius);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const pathData = `M ${centerX},${centerY} L ${start.x},${start.y} A ${radius},${radius} 0 0 1 ${end.x},${end.y} Z`;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const labelAngle = startAngle + (angleStep / 2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const labelPos = polarToCartesian(labelAngle, radius * 0.7);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return createElement('g', { key: stage.id, onClick: () =&gt; onStageClick(stage.id), style: { cursor: 'pointer' } },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>createElement('path', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>d: pathData,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>fill: hasText ? '#dcfce7' : '#fee2e2',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>stroke: '#fafafa',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>strokeWidth: '3'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>createElement('text', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>x: labelPos.x,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>y: labelPos.y,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>textAnchor: 'middle',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>dy: '.3em',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className: `font-semibold fill-current ${hasText ? 'text-green-800' : 'text-red-800'}`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}, stage.label)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement('circle', { cx: centerX, cy: centerY, r: 70, fill: centerColor, stroke: '#fafafa', strokeWidth: '3' }),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement('text', { x: centerX, y: centerY, textAnchor: 'middle', dy: '.3em', className: `font-bold text-xl fill-current ${textColor}` }, "A+ Inquiry")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const HelpModal = ({ onClose }) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return createPortal(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement('div', { className: "fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-start p-4 overflow-y-auto" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>createElement('div', { className: "bg-white rounded-xl shadow-2xl w-full max-w-3xl transform transition-all my-8" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>createElement('div', { className: "flex justify-between items-center p-4 border-b" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('h2', { className: "text-xl font-bold" }, 'How to Use the App'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('button', { onClick: onClose, className: "text-3xl" }, '×')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>createElement('div', { className: 'p-6 space-y-6 text-gray-700' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('div', null,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('h3', { className: 'text-lg font-bold text-gray-800 mb-2' }, '1. Adding and Editing Scenarios'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('p', { className: 'mb-2'}, 'Click the "New" button to open a form. Fill out the fields for each stage of the A+ Inquiry process.'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('p', null, 'To edit an existing scenario, select it from the dropdown, then click the yellow "Edit" button on its card, or click directly on a section of the diagram to jump to that question.')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>createElement('div', null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('h3', { className: 'text-lg font-bold text-gray-800 mb-2' }, '2. Viewing a Scenario'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('p', null, 'Use the "Select a Scenario..." dropdown menu at the top of the page to choose a saved scenario. Its details will appear on the page.')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('div', null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('h3', { className: 'text-lg font-bold text-gray-800 mb-2' }, '3. Understanding the Diagram'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('p', null, 'The diagram provides a quick overview of your scenario\'s completeness:'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('ul', {className: 'list-disc list-inside ml-4 mt-2 space-y-1'},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>createElement('li', null, 'A pie slice is ', createElement('strong', {className: 'text-green-600'}, 'green'), ' if you have entered a response for that stage.'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>createElement('li', null, 'A pie slice is ', createElement('strong', {className: 'text-red-600'}, 'red'), ' if the response is empty.'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>createElement('li', null, 'The center circle shows the overall status: ', createElement('strong', {className: 'text-yellow-600'}, 'yellow'), ' for in-progress, ', createElement('strong', {className: 'text-green-600'}, 'green'), ' for complete, and ', createElement('strong', {className: 'text-red-600'}, 'red'), ' for not started.')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>createElement('div', null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('h3', { className: 'text-lg font-bold text-gray-800 mb-2' }, '4. Generating Narratives with AI'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('p', null, 'Once a scenario is displayed, you will see two narrative generation buttons:'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('ul', {className: 'list-disc list-inside ml-4 mt-2 space-y-1'},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                     </span>createElement('li', null, createElement('strong', null, 'A+ Inquiry Narrative:'), ' Creates a report using the A+ Inquiry headings (Absorb, Ask, etc.).'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                     </span>createElement('li', null, createElement('strong', null, 'Traditional Narrative:'), ' Creates a report using standard research headings (Introduction, Methods, etc.).')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('p', {className: 'mt-2'}, 'After a narrative is generated, you can click "Edit Narrative" to refine the text, or "Revert to Original" to go back to your structured answers.')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>createElement('div', null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('h3', { className: 'text-lg font-bold text-gray-800 mb-2' }, '5. Exporting Your Work'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('p', null, 'When viewing a generated narrative, "Export to PDF" and "Export to Word" buttons will appear. Click these to download your narrative in the chosen format.')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>), document.body</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const ScenarioCard = ({ item, onEdit, onDelete }) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [isNarrativeView, setIsNarrativeView] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [narrativeText, setNarrativeText] = useState('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [isGenerating, setIsGenerating] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [error, setError] = useState(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [isEditingNarrative, setIsEditingNarrative] = useState(false);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleGenerateNarrative = async (narrativeType) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setIsGenerating(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setError(null);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let prompt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (narrativeType === 'A+') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>prompt = `You are an expert in educational and research methodologies. Your task is to synthesize a set of structured answers from the "A+ Inquiry" framework into a cohesive narrative report. For each stage of the A+ Inquiry framework (e.g., Absorb, Ask, Accumulate), use the stage name as a bold heading. Under each heading, rewrite the user's provided point for that stage into a well-formed, narrative paragraph. Do not simply copy the user's text. The overall tone should be professional and clear. Here are the user's responses for the scenario titled "${item.scenarioTitle || 'Untitled'}":\n\n` +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>formFields</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>.filter(field =&gt; field.id !== 'scenarioTitle' &amp;&amp; item[field.id])</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>.map(field =&gt; `**${field.label}:**\n${item[field.id]}`)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>.join('\n\n');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else if (narrativeType === 'Traditional') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>prompt = `You are an expert in academic writing. Your task is to convert a set of structured answers from a planning exercise into a traditional research paper format. Use the following bold headings: **Introduction**, **Methods**, **Results**, and **Discussion**.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">- For the **Introduction**, synthesize the following points about the background knowledge and the questions being asked.</span></p>
<p class="p1"><span class="s1">- For the **Methods**, synthesize the following points about data collection, access, and analysis.</span></p>
<p class="p1"><span class="s1">- For the **Results**, use the following point about the answer found.</span></p>
<p class="p1"><span class="s1">- For the **Discussion**, synthesize the following points about communicating the findings and applying them.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Rewrite the user's points under each heading into well-formed, narrative paragraphs. The tone should be formal and academic. Here is the user's raw input for the scenario titled "${item.scenarioTitle || 'Untitled'}":</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">**Material for Introduction:**</span></p>
<p class="p1"><span class="s1">${item.absorb || ''}</span></p>
<p class="p1"><span class="s1">${item.ask || ''}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">**Material for Methods:**</span></p>
<p class="p1"><span class="s1">${item.accumulate || ''}</span></p>
<p class="p1"><span class="s1">${item.access || ''}</span></p>
<p class="p1"><span class="s1">${item.analyze || ''}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">**Material for Results:**</span></p>
<p class="p1"><span class="s1">${item.answer || ''}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">**Material for Discussion:**</span></p>
<p class="p1"><span class="s1">${item.announce || ''}</span></p>
<p class="p1"><span class="s1">${item.apply || ''}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>const payload = { contents: chatHistory };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>const apiKey = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>const response = await fetch(apiUrl, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>method: 'POST',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>headers: { 'Content-Type': 'application/json' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>body: JSON.stringify(payload)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                     </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>if (!response.ok) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>throw new Error(`API request failed with status ${response.status}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>const result = await response.json();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>if (result.candidates &amp;&amp; result.candidates.length &gt; 0 &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>result.candidates[0].content &amp;&amp; result.candidates[0].content.parts &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>result.candidates[0].content.parts.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>const text = result.candidates[0].content.parts[0].text;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>setNarrativeText(text);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>setIsNarrativeView(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>setIsEditingNarrative(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>throw new Error("Invalid response structure from API.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("Narrative generation error:", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setError("Failed to generate narrative. Please try again.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} finally {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setIsGenerating(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleExportPDF = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const { jsPDF } = window.jspdf;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const doc = new jsPDF();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const pageHeight = doc.internal.pageSize.getHeight();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const margin = 15;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let y = margin + 15;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>doc.setFontSize(18);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>doc.text(item.scenarioTitle || 'Scenario Narrative', margin, y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>y += 10;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>doc.setFontSize(12);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const splitText = doc.splitTextToSize(narrativeText, doc.internal.pageSize.getWidth() - margin * 2);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>splitText.forEach(line =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (y &gt; pageHeight - margin) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>doc.addPage();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>y = margin;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>doc.text(line, margin, y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>y += 7;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>doc.save((item.scenarioTitle || 'narrative') + '.pdf');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleExportWord = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const header = `&lt;html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'&gt;&lt;head&gt;&lt;meta charset='utf-8'&gt;&lt;title&gt;${item.scenarioTitle || 'Scenario Narrative'}&lt;/title&gt;&lt;/head&gt;&lt;body&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const footer = "&lt;/body&gt;&lt;/html&gt;";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const htmlContent = header + `&lt;h1&gt;${item.scenarioTitle || 'Scenario Narrative'}&lt;/h1&gt;&lt;p&gt;${narrativeText.replace(/\n/g, '&lt;br /&gt;')}&lt;/p&gt;` + footer;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const blob = new Blob(['\ufeff', htmlContent], {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>type: 'application/msword'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const url = URL.createObjectURL(blob);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const link = document.createElement("a");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.body.appendChild(link);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>link.href = url;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>link.download = `${item.scenarioTitle || 'narrative'}.doc`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>link.click();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.body.removeChild(link);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>URL.revokeObjectURL(url);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const renderCardContent = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (isNarrativeView) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (isEditingNarrative) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return createElement('textarea', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className: "w-full p-2 border border-gray-300 rounded-md shadow-sm h-96",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>value: narrativeText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>onChange: (e) =&gt; setNarrativeText(e.target.value)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return createElement('p', {className: "text-gray-800 whitespace-pre-wrap"}, narrativeText);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return formFields</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>.filter(f =&gt; f.id !== 'scenarioTitle')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>.map(f =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const hasText = item[f.id] &amp;&amp; item[f.id].trim() !== '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return createElement('div', { key: f.id, className: "mb-4" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('p', { className: "font-bold text-gray-700" }, f.label),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('p', {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>className: hasText ? "text-gray-600 whitespace-pre-wrap" : "text-gray-400 italic whitespace-pre-wrap"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}, hasText ? item[f.id] : 'No response entered.')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const renderActionButtons = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const buttons = [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (isGenerating) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>buttons.push(createElement('p', { key: 'gen', className: 'text-sm text-gray-500' }, "Generating..."));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>buttons.push(createElement(Button, { key: 'generate-aplus', onClick: () =&gt; handleGenerateNarrative('A+'), className: "bg-purple-600 hover:bg-purple-700 text-white text-sm py-1 px-3" }, "A+ Inquiry Narrative"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>buttons.push(createElement(Button, { key: 'generate-trad', onClick: () =&gt; handleGenerateNarrative('Traditional'), className: "bg-teal-600 hover:bg-teal-700 text-white text-sm py-1 px-3" }, "Traditional Narrative"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (isNarrativeView) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (isEditingNarrative) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>buttons.push(createElement(Button, { key: 'save-narrative', onClick: () =&gt; setIsEditingNarrative(false), className: "bg-green-600 hover:bg-green-700 text-white text-sm py-1 px-3" }, "Save Narrative"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>buttons.push(createElement(Button, { key: 'export-pdf', onClick: handleExportPDF, className: "bg-red-500 hover:bg-red-600 text-white text-sm py-1 px-3" }, "Export PDF"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>buttons.push(createElement(Button, { key: 'export-word', onClick: handleExportWord, className: "bg-blue-700 hover:bg-blue-800 text-white text-sm py-1 px-3" }, "Export Word"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>buttons.push(createElement(Button, { key: 'edit-narrative', onClick: () =&gt; setIsEditingNarrative(true), className: "bg-blue-500 hover:bg-blue-600 text-white text-sm py-1 px-3" }, "Edit Narrative"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>buttons.push(createElement(Button, { key: 'revert', onClick: () =&gt; { setIsNarrativeView(false); setIsEditingNarrative(false); }, className: "bg-gray-500 hover:bg-gray-600 text-white text-sm py-1 px-3" }, "Revert to Original"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>buttons.push(createElement(Button, { key: 'edit', onClick: () =&gt; onEdit(item), className: "bg-yellow-500 hover:bg-yellow-600 text-white text-sm py-1 px-3" }, "Edit"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>buttons.push(createElement(Button, { key: 'delete', onClick: () =&gt; onDelete(item.id), className: "bg-red-600 hover:bg-red-700 text-white text-sm py-1 px-3" }, "Delete"));</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return buttons;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return createElement('div', { className: "bg-white rounded-lg shadow-md p-6 mb-6 border" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement('h3', { className: "text-xl font-bold text-blue-700 mb-4" }, item.scenarioTitle || 'Untitled'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement(InquiryDiagram, { item, onStageClick: (stageId) =&gt; onEdit(item, stageId) }),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>renderCardContent(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>error &amp;&amp; createElement('p', {className: 'text-red-500 text-sm mt-2'}, error),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement('div', { className: "flex justify-end items-center flex-wrap gap-2 mt-6 border-t pt-4" }, ...renderActionButtons())</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// --- Main Application Component ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function App({ firebaseServices }) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const { auth, db } = firebaseServices;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [userId, setUserId] = useState(auth.currentUser?.uid);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [isAuthReady, setIsAuthReady] = useState(!!auth.currentUser);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [userSubmissions, setUserSubmissions] = useState([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [isLoadingData, setIsLoadingData] = useState(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [error, setError] = useState(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [selectedScenarioId, setSelectedScenarioId] = useState('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [isFormModalOpen, setIsFormModalOpen] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [itemToDelete, setItemToDelete] = useState(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [editingItem, setEditingItem] = useState(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [isHelpModalOpen, setIsHelpModalOpen] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [focusOnFieldId, setFocusOnFieldId] = useState(null);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleOpenFormModal = (item, stageId = null) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setEditingItem(item);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setFocusOnFieldId(stageId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setIsFormModalOpen(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleCloseFormModal = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setIsFormModalOpen(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setEditingItem(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setFocusOnFieldId(null);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>useEffect(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const unsubscribe = onAuthStateChanged(auth, (user) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (user) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>setUserId(user.uid);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>setIsAuthReady(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} else { setError("Authentication lost. Please refresh."); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return () =&gt; unsubscribe();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, [auth]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>useEffect(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!isAuthReady || !userId) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setIsLoadingData(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const dataCollectionPath = `artifacts/${appId}/users/${userId}/submissions`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const q = query(collection(db, dataCollectionPath));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const unsubscribe = onSnapshot(q, (querySnapshot) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setUserSubmissions(querySnapshot.docs.map(d =&gt; ({ id: d.id, ...d.data() })));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setIsLoadingData(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}, (err) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("Data fetch error:", err);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setError("Failed to load your scenarios.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setIsLoadingData(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return () =&gt; unsubscribe();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, [isAuthReady, userId]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleSave = async (formData) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!userId) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const path = `artifacts/${appId}/users/${userId}/submissions`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (editingItem) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>await updateDoc(doc(db, path, editingItem.id), formData);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const docRef = await addDoc(collection(db, path), { ...formData, createdAt: new Date() });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>setSelectedScenarioId(docRef.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>handleCloseFormModal();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("Save error:", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setError("Could not save the scenario.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleDeleteConfirm = async () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!userId || !itemToDelete) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await deleteDoc(doc(db, `artifacts/${appId}/users/${userId}/submissions`, itemToDelete));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (selectedScenarioId === itemToDelete) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>setSelectedScenarioId('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setIsDeleteModalOpen(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setItemToDelete(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("Delete error:", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setError("Could not delete the scenario.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const selectedScenario = selectedScenarioId ? userSubmissions.find(s =&gt; s.id === selectedScenarioId) : null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (error) return createElement('div', { className: "flex justify-center items-center h-screen bg-red-50 text-red-700 font-semibold p-4" }, error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isAuthReady) return createElement(LoadingSpinner, { message: "Finalizing Authentication..." });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return createElement('div', { className: "min-h-screen bg-gray-100" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement('header', { className: "bg-white shadow-sm sticky top-0 z-20" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>createElement('div', { className: "container mx-auto px-6 py-4 flex justify-between items-center" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>createElement('div', {className: "flex items-center gap-4"},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>createElement('h1', { className: "text-2xl font-bold text-gray-800" }, "A+ Inquiry Scenario Builder"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>createElement('select', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                 </span>className: "w-64 border border-gray-300 rounded-md py-2 px-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 truncate",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                 </span>value: selectedScenarioId,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                 </span>onChange: (e) =&gt; setSelectedScenarioId(e.target.value)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                 </span>createElement('option', { value: "" }, "Select a Scenario..."),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                 </span>...userSubmissions.map(scenario =&gt;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                     </span>createElement('option', { key: scenario.id, value: scenario.id }, scenario.scenarioTitle || "Untitled")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                 </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>createElement('div', { className: 'flex items-center gap-2' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement(Button, { onClick: () =&gt; handleOpenFormModal(null), className: "bg-blue-600 hover:bg-blue-700 text-white" }, "New"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement(Button, { onClick: () =&gt; setIsHelpModalOpen(true), className: "bg-gray-200 hover:bg-gray-300 text-gray-800 p-2" },<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('svg', { xmlns: 'http://www.w3.org/2000/svg', className: 'h-6 w-6', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z' })</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement('main', { className: "container mx-auto p-6" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>isLoadingData</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>? createElement(LoadingSpinner, { message: "Loading your scenarios..." })</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>: selectedScenario</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>? createElement(ScenarioCard, {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>key: selectedScenario.id,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>item: selectedScenario,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onEdit: handleOpenFormModal,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onDelete: (id) =&gt; { setItemToDelete(id); setIsDeleteModalOpen(true); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>: createElement('div', { className: 'text-center text-gray-500 py-12' }, 'Select a scenario to view it, or create a new one.')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>createElement('footer', { className: "text-center py-4 text-gray-500 text-sm space-y-2" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>createElement('p', null, "Your User ID is: ", createElement('span', { className: "font-mono bg-gray-200 p-1 rounded text-xs" }, userId)),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>createElement('p', null,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>'Developed by Nathan C. Anderson. ',<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>createElement('a', {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>href: "https://www.andersoninquiry.com/a-inquiry",<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>target: "_blank",<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>rel: "noopener noreferrer",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className: "text-blue-600 hover:underline"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}, 'Learn more about A+ Inquiry.')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>isFormModalOpen &amp;&amp; createPortal(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>createElement('div', { className: "fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-start p-4 overflow-y-auto" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>createElement('div', { className: "bg-white rounded-xl shadow-2xl w-full max-w-2xl transform transition-all my-8" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('div', { className: "flex justify-between items-center p-4 border-b" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('h2', { className: "text-xl font-bold" }, editingItem ? 'Edit Scenario' : 'Create New Scenario'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement('button', { onClick: handleCloseFormModal, className: "text-3xl" }, '×')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('div', { className: 'p-6' },<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement(DataForm, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>onSave: handleSave,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>initialData: editingItem,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>onCancel: handleCloseFormModal,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>isEditMode: !!editingItem,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>focusOnFieldId: focusOnFieldId</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>), document.body</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>isDeleteModalOpen &amp;&amp; createPortal(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>createElement('div', { className: "fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>createElement('div', { className: "bg-white rounded-xl p-6" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('h3', { className: "text-lg font-bold" }, "Confirm Deletion"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('p', { className: "my-4" }, "Are you sure? This cannot be undone."),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>createElement('div', { className: "flex justify-end space-x-3" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement(Button, { onClick: () =&gt; setIsDeleteModalOpen(false), className: "bg-gray-300 text-gray-800" }, "Cancel"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>createElement(Button, { onClick: handleDeleteConfirm, className: "bg-red-600 text-white" }, "Delete")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>), document.body</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>isHelpModalOpen &amp;&amp; createElement(HelpModal, { onClose: () =&gt; setIsHelpModalOpen(false) })</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function main() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const rootElement = document.getElementById('root');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const root = ReactDOM.createRoot(rootElement);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>root.render(createElement(LoadingSpinner, { message: "Initializing..." }));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!firebaseConfig) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>root.render(createElement('div', null, 'Error: Firebase configuration is missing.'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const app = initializeApp(firebaseConfig);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const auth = getAuth(app);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const db = getFirestore(app);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await signInAnonymously(auth);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>root.render(createElement(App, { firebaseServices: { auth, db } }));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch(error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Critical Initialization Error:", error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>root.render(createElement('div', { className: "p-4 text-center text-red-700 bg-red-100" }, `Critical Error: Could not start the application. ${error.message}`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>main();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
